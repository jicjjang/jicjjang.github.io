{"version":3,"sources":["webpack:///./src/utils/speech.ts","webpack:///./src/components/PostHeader.tsx","webpack:///./src/utils/comments.ts","webpack:///./src/templates/PostTemplate.tsx"],"names":["Speech","isSupportedSpeech","SpeechSynthesisUtterance","speechSynthesis","console","error","window","onbeforeunload","stopSpeech","sendMessage","text","voiceIndex","this","speaking","cancel","message","rate","voices","getVoices","voice","speak","sendContentsMessage","postArticleElement","document","querySelector","innerText","StyledHeader","styled","header","props","rhythm","StyledH1Link","Link","StyledSpeechSpan","span","StyledTime","time","scale","fontSize","lineHeight","PostHeader","title","path","date","isPost","to","onClick","speech","className","dateTime","removeComments","utterancesElement","remove","PostTemplate","data","utterancElement","createElement","setAttribute","body","appendChild","addComments","useEffect","site","markdownRemark","frontmatter","tags","excerpt","html","Default","siteMetadata","description","dangerouslySetInnerHTML","__html","style","marginBottom","color","length","PostTags","display","flexWrap","justifyContent","listStyle","padding"],"mappings":"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","file":"component---src-templates-post-template-tsx-e9c916fc5ea161c75466.js","sourcesContent":["class Speech {\n  constructor() {}\n\n  private isSupportedSpeech() {\n    if (typeof SpeechSynthesisUtterance === 'undefined' || typeof speechSynthesis === 'undefined') {\n      console.error('This browser does not support speech API');\n      return false;\n    }\n\n    window.onbeforeunload = () => this.stopSpeech();\n\n    return true;\n  }\n\n  public sendMessage(text, voiceIndex = 0) {\n    if (this.isSupportedSpeech()) {\n      if (window.speechSynthesis.speaking) {\n        window.speechSynthesis.cancel();\n      }\n\n      const message = new SpeechSynthesisUtterance(text);\n      message.rate = 1;\n      const voices = speechSynthesis.getVoices();\n\n      message.voice = voices[voiceIndex];\n      speechSynthesis.speak(message);\n    }\n  }\n\n  public sendContentsMessage() {\n    const postArticleElement = document.querySelector('.post_article') as HTMLElement;\n    if (postArticleElement?.innerText) {\n      this.sendMessage(postArticleElement?.innerText);\n    }\n  }\n\n  public stopSpeech() {\n    if (this.isSupportedSpeech() && window.speechSynthesis.speaking) {\n      window.speechSynthesis.cancel();\n    }\n  }\n}\n\nexport default new Speech();\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseLine } from 'typography';\nimport { Link } from 'gatsby';\n\nimport { scale, rhythm } from '~/configs/typography';\nimport { StyledCommonH1Title } from '~/components/common';\nimport speech from '~/utils/speech';\n\nconst StyledHeader = styled.header<{ rhythm: string }>`\n  margin-bottom: ${props => props.rhythm};\n`;\n\nconst StyledH1Link = styled(Link)`\n  color: #000;\n  &:hover {\n    color: #172fde;\n  }\n`;\n\nconst StyledSpeechSpan = styled.span`\n  display: inline-block;\n  width: 30px;\n  height: 30px;\n  background-image: url(/img/post/speaker.png);\n  background-size: 22px;\n  background-repeat: no-repeat;\n  background-position: 6px 10px;\n  &:active {\n    background-position: 6px 11px;\n  }\n`;\n\nconst StyledTime = styled.time<{ scale: BaseLine }>`\n  color: #898989;\n  font-size: ${props => props.scale.fontSize};\n  line-height: ${props => props.scale.lineHeight};\n`;\n\ninterface IProps {\n  title: string;\n  path?: string;\n  date: string;\n  isPost?: boolean;\n}\n\nconst PostHeader: React.FunctionComponent<IProps> = ({ title, path, date, isPost = false }) => {\n  return (\n    <StyledHeader rhythm={rhythm(1.2)}>\n      <StyledCommonH1Title scale={scale(0.5)} rhythm={rhythm(0.2)}>\n        {path ? <StyledH1Link to={path!}>{title}</StyledH1Link> : title}\n        {isPost && <StyledSpeechSpan onClick={() => speech.sendContentsMessage()} />}\n      </StyledCommonH1Title>\n      <p className=\"post-meta\">\n        <StyledTime dateTime={date} scale={scale(-0.1)}>\n          {date}\n        </StyledTime>\n      </p>\n    </StyledHeader>\n  );\n};\n\nexport default PostHeader;\n","export const addComments = () => {\n  if (typeof document !== 'undefined') {\n    const utterancElement = document.createElement('script');\n    utterancElement.setAttribute('src', 'https://utteranc.es/client.js');\n    utterancElement.setAttribute('repo', 'jicjjang/jicjjang.github.io');\n    utterancElement.setAttribute('issue-term', 'pathname');\n    utterancElement.setAttribute('label', '✨댓글✨');\n    utterancElement.setAttribute('theme', 'github-light');\n    utterancElement.setAttribute('async', 'true');\n\n    document.body.appendChild(utterancElement);\n  }\n};\n\nexport const removeComments = () => {\n  if (typeof document !== 'undefined') {\n    const utterancesElement = document.querySelector('.utterances');\n    if (utterancesElement && document.querySelector('.utterances-frame')) {\n      utterancesElement.remove();\n    }\n  }\n};\n","import * as React from 'react';\nimport { useEffect } from 'react';\nimport {\n  // Link,\n  graphql,\n  PageProps\n} from 'gatsby';\n\nimport DefaultLayout from '~/components/layout/Default';\nimport { rhythm } from '~/configs/typography';\nimport { IQuerySiteData } from '~/interface';\nimport PostHeader from '~/components/PostHeader';\nimport PostTags from '~/components/PostTags';\nimport { addComments, removeComments } from '~/utils/comments';\nimport speech from '~/utils/speech';\n\ninterface IQuerydMarkdownData {\n  markdownRemark: {\n    id: string;\n    excerpt: string;\n    html: string;\n    frontmatter: {\n      title: string;\n      date: string;\n      tags: string[];\n    };\n  };\n}\n\nconst PostTemplate: React.FunctionComponent<PageProps> = ({ data }) => {\n  /**\n   * @description 댓글 라이브러리를 post에만 추가, unmount에서 제거!\n   */\n  removeComments();\n  addComments();\n\n  useEffect(() => {\n    return () => {\n      removeComments();\n      speech.stopSpeech(); // speech.ts의 onbeforeunload와 이벤트가 겹칠 수 있긴 함.\n    };\n  }, []);\n\n  const { site, markdownRemark } = data as IQuerySiteData<{ title: string }> & IQuerydMarkdownData;\n  const {\n    frontmatter: { title, date, tags },\n    excerpt,\n    html\n  } = markdownRemark;\n  // const { previous, next } = pageContext;\n\n  return (\n    <DefaultLayout title={site.siteMetadata.title} description={excerpt}>\n      <article className=\"post_article\">\n        <PostHeader title={title!} date={date} isPost={true} />\n        <section dangerouslySetInnerHTML={{ __html: html }} />\n        <hr\n          style={{\n            marginBottom: rhythm(1)\n          }}\n        />\n        <footer style={{ color: '#898989' }}>{tags?.length && <PostTags tags={tags} />}</footer>\n      </article>\n\n      <nav>\n        <ul\n          style={{\n            display: `flex`,\n            flexWrap: `wrap`,\n            justifyContent: `space-between`,\n            listStyle: `none`,\n            padding: 0\n          }}>\n          {/* @TODO 이전, 이후 포스팅 추가하기 */}\n          {/* <li>\n            {previous && (\n              <Link to={previous.fields.slug} rel=\"prev\">\n                ← {previous.frontmatter.title}\n              </Link>\n            )}\n          </li>\n          <li>\n            {next && (\n              <Link to={next.fields.slug} rel=\"next\">\n                {next.frontmatter.title} →\n              </Link>\n            )}\n          </li> */}\n        </ul>\n      </nav>\n    </DefaultLayout>\n  );\n};\n\nexport default PostTemplate;\n\nexport const query = graphql`\n  query BlogPostBySlug($slug: String!) {\n    site {\n      siteMetadata {\n        title\n      }\n    }\n    markdownRemark(fields: { slug: { eq: $slug } }) {\n      id\n      excerpt(pruneLength: 160)\n      html\n      frontmatter {\n        title\n        date(formatString: \"MMMM DD, YYYY\")\n        tags\n      }\n    }\n  }\n`;\n"],"sourceRoot":""}