{"componentChunkName":"component---src-templates-post-template-tsx","path":"/posts/gatsby-linke-issue","result":{"data":{"site":{"siteMetadata":{"title":"June"}},"markdownRemark":{"id":"91063dcf-3512-5ea5-8a4a-6dd85bccd01c","excerpt":"현재 진행 중인 블로그 개편을 (매번 할 프로젝트 없을 때, 테스트베드가 되는 블로그...) Gatsbyjs를 이용하여\n진행중 입니다. Gatsbyjs…","html":"<p>현재 진행 중인 블로그 개편을 (매번 할 프로젝트 없을 때, 테스트베드가 되는 블로그...) <a href=\"https://www.gatsbyjs.org/\" target=\"_blank\" rel=\"noopener\">Gatsbyjs</a>를 이용하여\n진행중 입니다. Gatsbyjs를 이용하며 블로그를 만들며 찾은 이슈에 대해 알아보겠습니다.</p>\n<hr>\n<p>우선 <code class=\"language-text\">Posts</code>, <code class=\"language-text\">Archive</code>가 있는 메뉴 영역을 아래와 같은 형식으로 만들었습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">enum</span> <span class=\"token constant\">MENU</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">POSTS</span> <span class=\"token operator\">=</span> <span class=\"token string\">'Posts'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">ARCHIVE</span> <span class=\"token operator\">=</span> <span class=\"token string\">'Archive'</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">NOT_CHOICE_COLOR</span> <span class=\"token operator\">=</span> <span class=\"token string\">'#898989'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CHOICE_COLOR</span> <span class=\"token operator\">=</span> <span class=\"token string\">'#000'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">MENU_MAPPED_PATH</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">.</span><span class=\"token constant\">POSTS</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ARCHIVE</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token string\">'/archive'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> StyleLiLink <span class=\"token operator\">=</span> <span class=\"token function\">styled</span><span class=\"token punctuation\">(</span>GatsbyLink<span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span>color<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  color: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> props<span class=\"token punctuation\">.</span>color<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">;\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">...</span>\n\n<span class=\"token comment\">// header > Menu > render 영역</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyledUl</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyledLi</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>key<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyleLiLink</span></span>\n            <span class=\"token attr-name\">color</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> pathname <span class=\"token operator\">?</span> <span class=\"token constant\">CHOICE_COLOR</span> <span class=\"token operator\">:</span> <span class=\"token constant\">NOT_CHOICE_COLOR</span><span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">to</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyleLiLink</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyledLi</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyledUl</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token operator\">...</span>\n  <span class=\"token punctuation\">)</span></code></pre></div>\n<p>그런데, 해당 영역이 아래 이미지와 같이 동일한 회색으로 나타났습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 480px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bbc64298bbf047e85497033bbdb5bd02/e4611/issue.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB4UlEQVQ4y6WUWY/qMAyF+/9/GE88IITYdyil7GtRN87tZ91UXGaGy8xEcp04jnNsn9TT07jf73o5in3zyDIpSQqJpTQx4ayX57mazaYqlYpGo1EZ1MlXF+ahryhcKD/sdNuslAQzKbrKy4qb2u22Go2GVqvVPwE/B/g3YDBXFPjK9ltF61CxPykCXuQ9OhM8TdPX6T+mjC/pZqmJpUwQ0NXrddVqNYVh+CHtTwWfJ2FYDY/How6Hg87ns06n0/+DvRCPD0Ef5TfDEE6nUwVBoPl8ruVyaXPf9229WCysDLPZzOxo5+ds+NBQ6m81JOB4PFa327WOQx+o1Ol0bM4B9vv9vlqtltmHw6H5Y0PwAZwFnEwmdttgMLA59dztdtpsNlbf/X5vwhpZr9eGaLvdmp0M8CtTBr5zpDFJ8QK46LujbEoURbper7pcLqbpNIGpyXc6bAjfvfn5BX0190DR6/WsGdVq1QjOmuJDeNC+9dNwtKFWFJjC0m3mpEtNKXocx++9HEdsnEFJ4J804gNCoj4+PUeT2+1mGpSghUakjw3txJ1lXvKQmkFcOMgcPrJ2ZHdEh8zsQ2T2sLs1r6dECMt5amgO4Yh2zwqEcBU7tQY9aACDpmTuH2AB3V8G/ZtBrD987wpvd4LVEQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"issue\"\n        title=\"issue\"\n        src=\"/static/bbc64298bbf047e85497033bbdb5bd02/e85cb/issue.png\"\n        srcset=\"/static/bbc64298bbf047e85497033bbdb5bd02/070ae/issue.png 120w,\n/static/bbc64298bbf047e85497033bbdb5bd02/8ff5a/issue.png 240w,\n/static/bbc64298bbf047e85497033bbdb5bd02/e85cb/issue.png 480w,\n/static/bbc64298bbf047e85497033bbdb5bd02/37523/issue.png 720w,\n/static/bbc64298bbf047e85497033bbdb5bd02/d9199/issue.png 960w,\n/static/bbc64298bbf047e85497033bbdb5bd02/e4611/issue.png 1298w\"\n        sizes=\"(max-width: 480px) 100vw, 480px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>map chainning을 했을 때, 이러한 경험을 한적은 없었기 때문에 우선 로그를 찍어보았습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// header > Menu > render 영역</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyledUl</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'key'</span><span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'MENU_MAPPED_PATH[MENU[key]] === pathname'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> pathname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyledLi</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>key<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyleLiLink</span></span>\n            <span class=\"token attr-name\">color</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> pathname <span class=\"token operator\">?</span> <span class=\"token constant\">CHOICE_COLOR</span> <span class=\"token operator\">:</span> <span class=\"token constant\">NOT_CHOICE_COLOR</span><span class=\"token punctuation\">}</span></span>\n            <span class=\"token attr-name\">to</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyleLiLink</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyledLi</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyledUl</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token operator\">...</span>\n  <span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 480px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e1b05ed0092c7e626f033e2a1478a46a/ba4d9/log1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA1ElEQVQY03WQ2XKEIBBF/ZIILpW4G8dlcEFFdHQy+f/PuYFO5TEPp6Cbqnu6cdq2Qz+M2B8XirKE676Bcw7GmLm7YAbOGfU8z4Pv+wiC4F+c8/nCOEkc5xPLuqFuWlPP1FPbjnlVEP2A7i7wWVWIkwRhGFKwT4I/iakDzwReL0xyhj5OwoatShPX1zdhQ4dR4i565EWBKIqRpiltlOU5sizHx3uCOCrh6P2BaV5oGmlO0Y8Y5e+E235A6YMkcllR3Wrc6gb2m6zESu270hpF1kE0F34AF3SA99Qs7rEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"log1\"\n        title=\"log1\"\n        src=\"/static/e1b05ed0092c7e626f033e2a1478a46a/e85cb/log1.png\"\n        srcset=\"/static/e1b05ed0092c7e626f033e2a1478a46a/070ae/log1.png 120w,\n/static/e1b05ed0092c7e626f033e2a1478a46a/8ff5a/log1.png 240w,\n/static/e1b05ed0092c7e626f033e2a1478a46a/e85cb/log1.png 480w,\n/static/e1b05ed0092c7e626f033e2a1478a46a/ba4d9/log1.png 564w\"\n        sizes=\"(max-width: 480px) 100vw, 480px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>렌더링을 위해 return하는 부분에서는 전혀 문제가 없습니다. 의심이 된 부분은 <a href=\"https://www.styled-components.com/\" target=\"_blank\" rel=\"noopener\">styled-components</a>.\nstyled-components로 감싸면서 무언가 이상이 생긴건가? 하는 의심이 들었습니다.</p>\n<p>동일한 로직에 styled-components를 제외하여 로그를 찍어보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// header > Menu > render 영역</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyledUl</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'key'</span><span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'MENU_MAPPED_PATH[MENU[key]]'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'MENU_MAPPED_PATH[MENU[key]] === pathname'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> pathname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyledLi</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>key<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">GatsbyLink</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* Gatsbyjs의 Link 이름을 바꿔서 export */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n            style=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n              color<span class=\"token operator\">:</span> <span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> pathname <span class=\"token operator\">?</span> <span class=\"token constant\">CHOICE_COLOR</span> <span class=\"token operator\">:</span> <span class=\"token constant\">NOT_CHOICE_COLOR</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n            to=</span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">>\n            </span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">GatsbyLink</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyledLi</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyledUl</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token operator\">...</span>\n  <span class=\"token punctuation\">)</span></code></pre></div>\n<p>하지만 동일한 에러가 나옵니다. styled-components에는 문제가 없다고 판단하고 여러 포인트를 바꿔가며 확인하던 도중 development 모드에선 정상동작,\nproduction 모드에서만 해당 이슈가 재현됨을 확인하였습니다.</p>\n<p>위 예제들과 같은 로그를 build시에도 그대로 넣어서 돌려보겠습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 331px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ebad89499f62f085c1652a4573db0e05/62452/log2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABWUlEQVQoz3VR147CQAzMR9ASUiFEQgSOIgRJCOUoIfQmgQDx/38xZ5vj3u5h5F3v2jNjK5PJBJ1OB0mSYDgcwnEc6LqOYrH4B74zDMMQmKb5L5TNZoPFYoH9fo/5fI5ut4tSqYRKpSJwXRflcllytm1LQybRNO0XKt0Nim8o9/sdt9sN2+0Wj8cDHwLOPZ9PvF4vnM9n7HY7IfN9H57nSazXfTQaX6hWHYomajXrrXC5XOJwOOB0OmG9XssIgiBAHMcYjUaIogiDwYAKq9Skjna7LbkwDDAef6PVcum/RbChzGYzKWIFPM9+v49CoYBsNivIZDLI5XLI5/NiVVVVef/k+KxpOkWD3sjy9XoVZayQz0zA7Gmailp2MJ1OhZTVsfowDEUx22YSyzJpvibNl5bC82Gw7ePxKJGVsuLL5SIkvDBu3Gw2xQE3W61WssQkSdHreVRjE6mDH3Y14RHR96pbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"log2\"\n        title=\"log2\"\n        src=\"/static/ebad89499f62f085c1652a4573db0e05/62452/log2.png\"\n        srcset=\"/static/ebad89499f62f085c1652a4573db0e05/070ae/log2.png 120w,\n/static/ebad89499f62f085c1652a4573db0e05/8ff5a/log2.png 240w,\n/static/ebad89499f62f085c1652a4573db0e05/62452/log2.png 331w\"\n        sizes=\"(max-width: 331px) 100vw, 331px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>예상대로 무언가 조금 이상합니다. pathname이 <code class=\"language-text\">/*</code> 라는 값으로 넘어왔습니다.\n우선 저 값에 대한 대응을 위해 값을 비교하는 부분에 예외처리를 추가해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// header > Menu > render 영역</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyledUl</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'key'</span><span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'MENU_MAPPED_PATH[MENU[key]]'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'MENU_MAPPED_PATH[MENU[key]] === pathname'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> pathname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyledLi</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>key<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyleLiLink</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* Gatsbyjs의 Link 이름을 바꿔서 export */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n            color=</span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> pathname <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>key <span class=\"token operator\">===</span> <span class=\"token string\">'POSTS'</span> <span class=\"token operator\">&amp;&amp;</span> pathname <span class=\"token operator\">===</span> <span class=\"token string\">'/*'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token constant\">CHOICE_COLOR</span> <span class=\"token operator\">:</span> <span class=\"token constant\">NOT_CHOICE_COLOR</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n            to=</span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">>\n            </span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyleLiLink</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        &lt;/StyledLi>\n      )\n      })}\n    &lt;/StyledUl>\n    ...\n  )</span></code></pre></div>\n<p>다행히 예상한대로 해결되었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 480px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/57a35a279490c8ad6c888b8d5ed681f0/7960f/resolve.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.166666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAU0lEQVQI141OwQkAMQzq/itlgawRskH7akjrYaBwr+sJATUitjEGeu+ICBB7b3zh/DMTc87S5DzypqoQEbh7Bddavwo5xMwqz0HUVfguuK275eg/lVjrz768GaEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"resolve\"\n        title=\"resolve\"\n        src=\"/static/57a35a279490c8ad6c888b8d5ed681f0/e85cb/resolve.png\"\n        srcset=\"/static/57a35a279490c8ad6c888b8d5ed681f0/070ae/resolve.png 120w,\n/static/57a35a279490c8ad6c888b8d5ed681f0/8ff5a/resolve.png 240w,\n/static/57a35a279490c8ad6c888b8d5ed681f0/e85cb/resolve.png 480w,\n/static/57a35a279490c8ad6c888b8d5ed681f0/37523/resolve.png 720w,\n/static/57a35a279490c8ad6c888b8d5ed681f0/d9199/resolve.png 960w,\n/static/57a35a279490c8ad6c888b8d5ed681f0/7960f/resolve.png 1274w\"\n        sizes=\"(max-width: 480px) 100vw, 480px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>build 시 이렇게 나오는 이유에 대해선 gatsbyjs의 코드를 조금 더 확인해봐야할 것 같습니다.\n하지만, 이런식의 예외처리는 깔끔하지 못한 것 같다는 생각이 들어 문서를 좀 더 확인해봤습니다.</p>\n<p>이러한 이슈에 대한 대응책인지 모르겠지만, <code class=\"language-text\">Link</code> 컴포넌트에 <a href=\"https://www.gatsbyjs.org/docs/gatsby-link/#show-active-styles-for-partially-matched-and-parent-links\" target=\"_blank\" rel=\"noopener\"><code class=\"language-text\">activeStyle</code>이라는 attribute</a>가 있었습니다.\n기본적인 color를 지정해주고, activeStyle(현재 url과 Link의 <code class=\"language-text\">to</code> attribute가 동일한지 여부를 구분하여 해당 스타일을 추가해줌)로 컨트롤 하는 방식으로 수정해보았습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> StyleLiLink <span class=\"token operator\">=</span> <span class=\"token function\">styled</span><span class=\"token punctuation\">(</span>GatsbyLink<span class=\"token punctuation\">)</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  color: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">NOT_CHOICE_COLOR</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">;\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// header > Menu > render 영역</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">...</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyledUl</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyledLi</span></span> <span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>key<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StyleLiLink</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* Gatsbyjs의 Link 이름을 바꿔서 export */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n            activeStyle=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n              color<span class=\"token operator\">:</span> <span class=\"token constant\">CHOICE_COLOR</span>             \n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n            to=</span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU_MAPPED_PATH</span><span class=\"token punctuation\">[</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">>\n            </span><span class=\"token punctuation\">{</span><span class=\"token constant\">MENU</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyleLiLink</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyledLi</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">StyledUl</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token operator\">...</span>\n  <span class=\"token punctuation\">)</span></code></pre></div>\n<p>development, production 모두 정상 동작함을 확인할 수 있습니다.</p>","frontmatter":{"title":"Gatsby Link 이슈","date":"May 02, 2020","tags":["renewal","gatsby"]}}},"pageContext":{"slug":"/posts/gatsby-linke-issue","previous":{"fields":{"slug":"/posts/2019-review"},"frontmatter":{"title":"2019년 회고"}},"next":{"fields":{"slug":"/posts/2020-rebuild-blog"},"frontmatter":{"title":"Gatsby 블로그 개편"}}}}}