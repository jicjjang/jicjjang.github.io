{"componentChunkName":"component---src-templates-post-template-tsx","path":"/posts/promise-and-async-await","result":{"data":{"site":{"siteMetadata":{"title":"June"}},"markdownRemark":{"id":"4c0ca48d-1803-57e5-b0e7-26ec70f4753a","excerpt":"이번 포스트에서는  를 알아보겠습니다. 보통 동기화를 위해서 많이 쓰는 방법은  입니다. 위와같은 방식을 이용하여 sync를 맞출 수 있었습니다. 편법이긴 하지만 promise나 async…","html":"<p>이번 포스트에서는 <code class=\"language-text\">자바스크립트의 동기를 위한 promise와 async</code> 를 알아보겠습니다.</p>\n<p>보통 동기화를 위해서 많이 쓰는 방법은 <code class=\"language-text\">setTimeout</code> 입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token function\">somethingFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  b <span class=\"token operator\">=</span> <span class=\"token function\">somethingAnotherFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>위와같은 방식을 이용하여 sync를 맞출 수 있었습니다. 편법이긴 하지만 promise나 async (제가 웹을 코딩하기도 이전에 나온 기능들이지만 ㅠㅠ)들이 나오기 전에는 으례 이 방식을 사용했다고 많이 들어왔습니다.</p>\n<p>이제는 이 방식을 벗어나기 위해 sync를 맞추기 위한 promise, async, setTimeout 세 기능들에 대해 알아보겠습니다.</p>\n<h3 id=\"1-setTimeout\" style=\"position:relative;\">1. setTimeout<a href=\"#1-setTimeout\" aria-label=\"1 setTimeout permalink\" class=\"autolink-headers-- after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// setTimeout</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">testSetTimeout</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1. Before callback'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2. callback function'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> callback <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'   Callback is not func!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'3. After callback'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token function\">runA</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">testSetTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'   Call about setTimeout callback func!!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>callback함수를 포함해 testSetTimeout 함수를 호출합니다. 함수 내부의\nsetTimeout에서 3000ms를 기다리는 동안 계속 다음 명령어가 실행되므로 <code class=\"language-text\">3. After callback</code>이\n찍힐 수밖에 없습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 480px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7cab7f647feea8939b30166bd51db987/d7542/settimeout.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 94.16666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAAEIklEQVQ4yy2U6VbbWBCEFTC2te+Wrc37gne8YAQYCFlgJplJZjI5ef8n+aZl8qNP+8q61dVV3VJWxw/cfPvF4eUXxfM/vH75wePn7zx8/cHxr5/cvvzN3et3Dk8vrPf3XC52TJd7ZusD803B+vDApnjicHzm8cNnlPnuke3THxwE5PrDV26//Efx8p3b1xL0J/ev3zj++e8JcHFV0O2M6fYmDIZzhuMl09U165tHdnfvuX//CaU329Gf7lgfX7i6+yR/PnO1l6rXj+z3R9aLLb18wKAzop+PyMKMrJERey3SMCX3I/Kkw3JbUDx+RMkHSzpdqdges5VWVpM5q/GCq+maeW/MdHjJrD9inPWYyHk2uGSY9wjqBi3DIVZ1upbJOGoxl/eUptsgsxz6psUsDCnmM4rVku14IjFmmaUcsoi15HWnwyLL6HoBmWkT1zXahs6h5bL1DRaBg5LYDqkA9nRdHrgU0wmHyZB9N2PTcNkEJtuGzU0SsAstrjyNiW0wdBw6QmLqmGx8k6JpsmvaKG3XI5ZqmQD2hfo0Tdn1exSDnNtRl33scX/Z42na52mYcuzH3PRy5nnGpNnkuuVQRDrPPYenrocSC7tMqmWWxajTYzoYMtRVloHFWtqY2XWWniosVLaBzkPX59gJmfkWY0ujaFncNHQBs/k0CVHsuk6gm+JUm5GIupouWKQJs1bEqp2yyVsUwvBunLNJfPaRwTFz2IYGc+etyE4K3sU6H4cuiq7bhG5Aw3Jpaga9kqnrMBJtFqHLwreZBTa72BWmGptQ5z632QurmVUT5ho3LdG5BE0tFMvx0TQTtaahnVVw353ROK8QVSq061XGRp2BVmPlaqfL18KwvLiQc0+vsRaGJfjSrnEQLZW66WIEEWaUYvhN/LhNw28QqBqJqtLRVAaGKu4ap/a2JaiwXIi2ea3CQpjdpiZrr84uUFFqqonhCVDeJ5BtaI7mRP0JYdYliBLSJKefpEwDj5VnsW0Fp7nbhLY8c1iWI5W57BNXHJeWqzLpFzWdmu5gRRlmGGMGTXQ3pCLboHsRVtjCa8SyahHLTpv7YYdd2mQm5u3bCQ8yStukwU0eoFzItDuyNm4r4fxCldA4q6i8O6ty/jsrioIiuVI1UKsqzVIK0Tc+PxN9q1yLFAsxqJREMYRBQ8bFFlA/69CUdlXb/w1ck6i/Fapq1DSHC9WiIlGXrqyLKm1dPW3KwpIsU6C40karK4BB2VoTr5lwISzenb+BnQlYGZW6yUXdQjU8DCc8SVS+o9dUUtnnoamJ02KKIbvsRTFRZ3DSyhGtAmFqyGepBKnKxUrNoCZAJUhdd9GtgNLMqmhcMi6Za/LbF/lOppT6eVmOn+a/W2/jxRl2I8FNO1hlTnpiViwA5gm4NLKMqma/nUsppPD/ShH5lv7Hol8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"settimeout\"\n        title=\"settimeout\"\n        src=\"/static/7cab7f647feea8939b30166bd51db987/e85cb/settimeout.png\"\n        srcset=\"/static/7cab7f647feea8939b30166bd51db987/070ae/settimeout.png 120w,\n/static/7cab7f647feea8939b30166bd51db987/8ff5a/settimeout.png 240w,\n/static/7cab7f647feea8939b30166bd51db987/e85cb/settimeout.png 480w,\n/static/7cab7f647feea8939b30166bd51db987/37523/settimeout.png 720w,\n/static/7cab7f647feea8939b30166bd51db987/d7542/settimeout.png 810w\"\n        sizes=\"(max-width: 480px) 100vw, 480px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>(<code class=\"language-text\">1. Before callback</code>, <code class=\"language-text\">3. After callback</code> 이후에 <code class=\"language-text\">2. callback function</code>, <code class=\"language-text\">Call about setTimeout callback func!!</code> 가 찍히는 모습.)</p>\n<h3 id=\"2-Promise\" style=\"position:relative;\">2. Promise<a href=\"#2-Promise\" aria-label=\"2 Promise permalink\" class=\"autolink-headers-- after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Promise</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">testPromise</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> callback <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1. callback is function.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2. callback is not a function.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token function\">runA</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">testPromise</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2. callback function!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'3. callback is done.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">reason</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>reason<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>callback함수를 포함해 testPromise를 호출하고, callback이 함수면 2000ms 뒤에 resolve()로 callback 파라미터를 포함해 다음 함수 (then)을 실행합니다. promise로 물려있는 then 함수들이 순서대로 실행됩니다. (reject 발생 시 catch로 들어갑니다.)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 480px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/273b9889ad53c9c12ba2bd85bc3af099/1e043/promise.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 131.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"promise\"\n        title=\"promise\"\n        src=\"/static/273b9889ad53c9c12ba2bd85bc3af099/e85cb/promise.png\"\n        srcset=\"/static/273b9889ad53c9c12ba2bd85bc3af099/070ae/promise.png 120w,\n/static/273b9889ad53c9c12ba2bd85bc3af099/8ff5a/promise.png 240w,\n/static/273b9889ad53c9c12ba2bd85bc3af099/e85cb/promise.png 480w,\n/static/273b9889ad53c9c12ba2bd85bc3af099/1e043/promise.png 690w\"\n        sizes=\"(max-width: 480px) 100vw, 480px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>(바로 <code class=\"language-text\">1. callback is function.</code> 이 실행되고 2초뒤에 <code class=\"language-text\">2. callback function!</code> 과 <code class=\"language-text\">3. callback is done</code> 이 실행되는 모습.)</p>\n<h3 id=\"3-async\" style=\"position:relative;\">3. async<a href=\"#3-async\" aria-label=\"3 async permalink\" class=\"autolink-headers-- after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">testPromise</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> callback <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1. callback is function.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> callback <span class=\"token operator\">===</span> <span class=\"token string\">'number'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1. callback number is '</span> <span class=\"token operator\">+</span> callback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>callback<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1. callback is not a function, number'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">testAsync</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token function\">testPromise</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> <span class=\"token function\">testPromise</span><span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> x <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> a<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">testAsync</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>우선 이 함수를 실행시켜볼 때 까지 몰랐던 것이... 크롬에서 ES6를 이미 지원해서 바로 실행된다는 것입니다...\n위 promise 예제에서 썼던 promise 생성 부분을 확장시켜, number 값이 들어오면 그 값을 보여주고 callback으로 넘겨주도록 만들어놓고 async 함수로 사용을 해봅니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 480px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/da369121349514993b6f9d662cd35219/0c3d0/async.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABPUlEQVQoz5WRiW7CMBBE8/8/2ItSyEkucBLb8bHOdJ22qLQg2pXGkaXdl/VMQtpD1iOK5wybzRbZ2w5DUWAqcsjjEYEIsZZlWXWvEu6CmhRen/bY7zI0RQkrTmf9GxiblNTYvlSo0xqibjH2PRzDaBCQeobS+gy7B03iEYGPDymqosKpbUEMCGZGsBae5VhfmLtA5x00A+WgwZOA4W0ibGYpxZIgYz6Af3h2YsYZdjK8EYejNEYWhfC7M8K+eXlLiRcWupFoDx2ytECe9fxM+sG6HLpWZ6DVdt3Qzh5WGbh4V+wbeXhPIE55uTF87SdJ07XYZznSrEbOoTRtB82hyEmuioEFCghsAwVav9dgM3teliWS+iBQVS2Go8DYTJC9glccyChAM287WhhhOCsDxSE55y5g4dNvKSVzKrwDgY4OMV02zFIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"async\"\n        title=\"async\"\n        src=\"/static/da369121349514993b6f9d662cd35219/e85cb/async.png\"\n        srcset=\"/static/da369121349514993b6f9d662cd35219/070ae/async.png 120w,\n/static/da369121349514993b6f9d662cd35219/8ff5a/async.png 240w,\n/static/da369121349514993b6f9d662cd35219/e85cb/async.png 480w,\n/static/da369121349514993b6f9d662cd35219/37523/async.png 720w,\n/static/da369121349514993b6f9d662cd35219/d9199/async.png 960w,\n/static/da369121349514993b6f9d662cd35219/0c3d0/async.png 1414w\"\n        sizes=\"(max-width: 480px) 100vw, 480px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>위와 같은 결과가 나옵니다. a, b에는 거의 동시에 promise로 들어가기에 <code class=\"language-text\">1. callback number is ~~</code> 가 두번 찍히게 되고, return 값에 있는 await에 해당하는 a와 b가 모두 할 일(promise의 2000ms)을 기다렸다가 끝나면 return을 하게됩니다.</p>\n<hr>\n<p>매우 간단한 것들이지만 setTimeout과는 다르게 promise와 async는 명확히 앞서 하던 일들이 끝나면 다음 일을 할 수 있도록 명시해줍니다. 이 차이 때문에라도 setTimeout을 사용하는 일은 그만해야 할 것입니다.</p>\n<p><strong>이번 회사 프로젝트를 하면서 Promise가 IE11에서도 먹히지 않는 모습을 보았습니다. 브라우저 호환성을 위해서 IE에서는 promise polyfill이나 async polyfill을 사용해야 합니다. async 또한 모든 브라우저에서 현재 ES6를 지원하는 것이 아니기 때문에 조심해서 사용해야 합니다.</strong></p>\n<p>오늘 포스팅은 여기서 마무리하겠습니다. 감사합니다.</p>","frontmatter":{"title":"자바스크립트 promise와 async/await","date":"February 05, 2017","tags":["javascript","async","await"]}}},"pageContext":{"slug":"/posts/promise-and-async-await","previous":{"fields":{"slug":"/posts/first-react-project-2"},"frontmatter":{"title":"첫 React 프로젝트 - 서버 세팅"}},"next":{"fields":{"slug":"/posts/front-end-question"},"frontmatter":{"title":"웹 front-end 개발 질문"}}}},"staticQueryHashes":["1576648375","1963346411"]}